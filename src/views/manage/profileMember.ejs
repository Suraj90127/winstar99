<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Member List</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback" />
    <link rel="stylesheet" href="/plugins/fontawesome-free/css/all.min.css" />
    <link rel="stylesheet" href="/dist/css/adminlte.min.css" />
    <link rel="stylesheet" href="/css/admin.css" />
    <style>
        body {
            background-color: #f0f4f8; /* Light background */
            color: #333; /* Dark text */
            font-family: 'Source Sans Pro', sans-serif;
        }


       
       .list-group-flush li a{
        background: transparent !important;
       }
        

       

        
       
    </style>
</head>

<body class="hold-transition sidebar-mini">
    <div class="wrapper">
        <%- include('nav') %>
        <div class="content-wrapper">
            <!-- Content Header (Page header) -->
            <section class="content-header">
                <div class="container-fluid">
                    <div class="row mb-2">
                        <div class="col-sm-6">
                            <h1>Member Information</h1>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Main content -->
            <section class="content">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-md-12">
                            <!-- Profile Image -->
                            <div class="card card-outline" style="border: none; border-radius: 15px; background: linear-gradient(135deg, #6a11cb, #2575fc); box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);">
                              <div class="card-body box-profile" style="padding: 30px; color: white;">
                                  <div class="text-center">
                                      <img class="profile-user-img img-fluid img-circle" src="/images/facebook.png" alt="User profile picture" style="width: 100px; height: 100px; border-radius: 50%; border: 4px solid white; box-shadow: 0 4px 10px rgba(255, 255, 255, 0.3);">
                                  </div>
                          
                                  <h3 class="profile-username text-center" style="color: #fff; font-size: 24px; font-weight: bold; margin-top: 15px;">Member Name</h3>
                          
                                  <p class="text-center" id="id_user" style="font-size: 16px; color: #dcdcdc;">ID: 0</p>
                          
                                  <ul class="list-group list-group-flush" style="margin-top: 20px; background: none; border-radius: 10px; overflow: hidden;">
                                      <li class="list-group-item" style="background: rgba(255, 255, 255, 0.1); border: none; padding: 15px 20px; color: white; display: flex; justify-content: space-between;">
                                          <b>Surplus</b> <a id="money" style="color: #ffeb3b; font-weight: bold; background-color: none;">0</a>
                                      </li>
                                      <li class="list-group-item" style="background: rgba(255, 255, 255, 0.2); border: none; padding: 15px 20px; color: white; display: flex; justify-content: space-between;">
                                          <b>Total Recharge</b> <a id="total_money" style="color: #ffeb3b; font-weight: bold;">0</a>
                                      </li>
                                      <li class="list-group-item" style="background: rgba(255, 255, 255, 0.1); border: none; padding: 15px 20px; color: white; display: flex; justify-content: space-between;">
                                          <b>Total Withdrawal</b> <a id="total_withdraw" style="color: #ffeb3b; font-weight: bold;">0</a>
                                      </li>
                                      <li class="list-group-item" style="background: rgba(255, 255, 255, 0.2); border: none; padding: 15px 20px; color: white; display: flex; justify-content: space-between;">
                                          <b>General Invitation</b> <a id="total_mem" style="color: #ffeb3b; font-weight: bold;">0</a>
                                      </li>
                                      <li class="list-group-item" style="background: rgba(255, 255, 255, 0.1); border: none; padding: 15px 20px; color: white; display: flex; justify-content: space-between;">
                                          <b>IP</b> <a id="ip" style="color: #ffeb3b; font-weight: bold;">157.296.591.22</a>
                                      </li>
                                      <li class="list-group-item" style="background: rgba(255, 255, 255, 0.2); border: none; padding: 15px 20px; color: white; display: flex; justify-content: space-between;">
                                          <b>Inviter</b> <a id="invite" style="color: #ffeb3b; font-weight: bold;">Loading...</a>
                                      </li>
                                      <li class="list-group-item" style="background: rgba(255, 255, 255, 0.1); border: none; padding: 15px 20px; color: white; display: flex; justify-content: space-between;">
                                          <b>Daily</b> <a id="daily" style="color: #ffeb3b; font-weight: bold; background-color: none;">Loading...</a>
                                      </li>
                                  </ul>
                          
                                  <a href="#" class="btn  btn-block" style="margin-top: 20px; background: linear-gradient(135deg, #f9698b, #e45036); border: none; color: white; font-size: 16px; padding: 12px; border-radius: 30px; box-shadow: 0 4px 15px rgba(255, 65, 108, 0.5);">
                                      <b style="text-transform: uppercase" id="level">ADMIN</b>
                                  </a>
                              </div>
                          </div>
                          

                            <!-- About Me Box -->
<div class="card" style="border: none; border-radius: 15px; background: linear-gradient(135deg, #ff6a00, #ee0979); color: white; box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);">
  <div class="card-header" style="border-bottom: 1px solid rgba(255, 255, 255, 0.2);">
      <h3 class="card-title" style="color: white; font-size: 22px; font-weight: bold;">Bank Information</h3>
  </div>
  <div class="card-body" style="padding: 25px;">
      <form method="post" action="/admin/member/editbank">
          <input name="phone" type="hidden" id="phoneban" />

          <div style="margin-bottom: 20px;">
              <strong>
                  <i class="fas fa-pencil-alt mr-1"></i>
                  <span style="font-size: 16px; color: #fff;">Bank Name</span>
              </strong>
              <p>
                  <input type="text" class="form-control" id="bank_name" name="bank_name" placeholder="Enter Bank Name" style="background: rgba(255, 255, 255, 0.1); border: none; color: white; padding: 10px; border-radius: 10px;">
              </p>
          </div>

          <div style="margin-bottom: 20px;">
              <strong>
                  <i class="fas fa-pencil-alt mr-1"></i>
                  <span style="font-size: 16px; color: #fff;">Account Name</span>
              </strong>
              <p>
                  <input type="text" class="form-control" id="name" name="names" placeholder="Enter Account Name" style="background: rgba(255, 255, 255, 0.1); border: none; color: white; padding: 10px; border-radius: 10px;">
              </p>
          </div>

          <div style="margin-bottom: 20px;">
              <strong>
                  <i class="far fa-file-alt mr-1"></i>
                  <span style="font-size: 16px; color: #fff;">Account Number</span>
              </strong>
              <p>
                  <input type="text" class="form-control" id="stk" name="stk" placeholder="Enter Account Number" style="background: rgba(255, 255, 255, 0.1); border: none; color: white; padding: 10px; border-radius: 10px;">
              </p>
          </div>

          <div style="margin-bottom: 20px;">
              <strong>
                  <i class="fas fa-map-marker-alt mr-1"></i>
                  <span style="font-size: 16px; color: #fff;">IFSC Code</span>
              </strong>
              <p>
                  <input type="text" class="form-control" id="ifsc" name="ifsc" placeholder="Enter IFSC Code" style="background: rgba(255, 255, 255, 0.1); border: none; color: white; padding: 10px; border-radius: 10px;">
              </p>
          </div>

          <div style="margin-bottom: 20px;">
              <strong>
                  <i class="fas fa-map-marker-alt mr-1"></i>
                  <span style="font-size: 16px; color: #fff;">USDT</span>
              </strong>
              <p>
                  <input type="text" class="form-control" id="upi" name="upi" placeholder="Enter UPI" style="background: rgba(255, 255, 255, 0.1); border: none; color: white; padding: 10px; border-radius: 10px;">
              </p>
          </div>

          <button type="submit" class="btn btn-primary btn-block" style="background: linear-gradient(135deg, #00f260, #0575e6); border: none; padding: 12px 20px; font-size: 16px; font-weight: bold; color: white; border-radius: 30px; box-shadow: 0 6px 15px rgba(0, 123, 255, 0.3);">
              <b style="text-transform: uppercase;">Edit</b>
          </button>
      </form>
  </div>
</div>

<!-- Other Section -->
<div class="col-md-12" style="overflow: auto; margin-top: 30px;">
  <!-- Table Recharge -->
  <%- include('table/listRecharge.ejs') %>
  <!-- END TABLE -->

  <!-- Table Withdraw -->
  <%- include('table/listWithdraw.ejs') %>
  <!-- END TABLE -->

  <!-- Table Red Envelope -->
  <%- include('table/listRedenvelope.ejs') %>
  <!-- END TABLE -->

  <!-- Table Bet -->
  <%- include('table/listBet.ejs') %>
  <!-- END TABLE -->
</div>

                    </div>
                </div>
            </section>
        </div>
    </div>
    <script src="/plugins/jquery/jquery.min.js"></script>
    <script src="/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="/dist/js/adminlte.min.js"></script>
    <script src="/js/admin/admin.js"></script>
    <script>
      function formateT(params) {
        let result = params < 10 ? "0" + params : params;
        return result;
      }

      function timerJoin(params = "") {
        let date = "";
        if (params) {
          date = new Date(Number(params));
        } else {
          date = Date.now();
          date = new Date(Number(date));
        }
        let years = formateT(date.getFullYear());
        let months = formateT(date.getMonth() + 1);
        let days = formateT(date.getDate());
        return years + " - " + months + " - " + days;
      }
    </script>
    <script>
      let url = window.location.pathname;
      let phones = url.split("/");
      let phone = phones[phones.length - 1];
      $.ajax({
        type: "POST",
        url: "/api/webapi/admin/member/info",
        data: {
          phone: phone,
        },
        dataType: "json",
        success: function (response) {
          if (response.status === false) return false;
          let user = response.datas[0];
          $(".profile-username").text(user.name_user);
          $("#id_user").text("ID: " + user.id_user);
          $("#money").text(user.money + ".0");
         // $("#invite").text(response.ng_moi.phone);
          $("#daily").text(response.daily);
          $("#total_mem").text(response.f1 + response.f2 + response.f3 + response.f4);
          $("#ip").text(user.ip_address);
          $("#level").text(user.level == 1 ? "ADMIN" : user.level == 2 ? "CTV" : "USER");
          $("#total_money").text(response.total_r[0].total ? response.total_r[0].total + ".0" : "0.0");
          $("#total_withdraw").text(response.total_w[0].total ? response.total_w[0].total + ".0" : "0.0");


          // Bank information
          if (response.bank_user[0]) {
            $("#phoneban").val(response.bank_user[0].id);
            $("#bank_name").val(response.bank_user[0].name_bank);
            $("#name").val(response.bank_user[0].name_user);
            $("#stk").val(response.bank_user[0].stk);
            $("#upi").val(response.bank_user[0].sdt);
            $("#ifsc").val(response.bank_user[0].email);
          }
        },
      });
    </script>

    <!-- Withdraw -->
    <script>
      const RenderWithdraw = (datas) => {
        if (datas.length == 0) {
          $("#list-withdraw").html(`
                    <tr class="text-center">
                    <td colspan="7">No data found!</td>
                    </tr>
                `);
          return;
        }
        let html = "";
        datas.map((data) => {
          html += `
                <tr class="text-center">
                    <td style="color: #e74c3c;font-weight: 600;min-width: 210px">${data.id_order}</td>
                    <td><b style="color: #3498db">${data.money}</b></td>
                    <td style="min-width: 210px;"><b>${data.name_bank}</b></td>
                    <td class="project-state"><span class="badge badge-${data.status == "1" ? "success" : "danger"}">${data.status == "1" ? "success" : "closed"}</span></td>
                    <td style="min-width: 210px;"><b>${data.today}</b></td>
                </tr>
                `;
        });
        $("#list-withdraw").html(html);
      };

      var pageno = 0;
      var limit = 15;
      var page = 1;
      $.ajax({
        type: "POST",
        url: "/admin/member/listWithdraw/<%=phone%>",
        data: {
          typeid: "1",
          pageno: pageno,
          limit: limit,
          language: "vi",
        },
        dataType: "json",
        success: function (response) {
          $("#text-withdraw").text(page + " / " + response.page_total);
          if (response.status === true) return RenderWithdraw(response.datas);
        },
      });

      $("#nextWithdraw").click(function (e) {
        pageno += limit;
        e.preventDefault();
        $.ajax({
          type: "POST",
          url: "/admin/member/listWithdraw/<%=phone%>",
          data: {
            typeid: "1",
            pageno: pageno,
            limit: limit,
            language: "vi",
          },
          dataType: "json",
          success: function (response) {
            if (response.datas.length == 0) {
              $("#nextWithdraw").addClass("block-click");
              return (pageno -= limit);
            }
            $("#text-withdraw").text(++page + " / " + response.page_total);
            if (response.status === true) return RenderWithdraw(response.datas);
          },
        });
      });

      $("#previousWithdraw").click(function (e) {
        e.preventDefault();
        $("#nextWithdraw").removeClass("block-click");
        pageno -= limit;
        if (pageno < 0) return (pageno = 0);
        $.ajax({
          type: "POST",
          url: "/admin/member/listWithdraw/<%=phone%>",
          data: {
            typeid: "1",
            pageno: pageno,
            limit: limit,
            language: "vi",
          },
          dataType: "json",
          success: function (response) {
            $("#text-withdraw").text(--page + " / " + response.page_total);
            if (response.status === true) return RenderWithdraw(response.datas);
          },
        });
      });
    </script>
    <!-- Withdraw -->

    <!-- Recharge -->
    <script>
      const RenderRecharge = (datas) => {
        if (datas.length == 0) {
          $("#list-recharge").html(`
                    <tr class="text-center">
                    <td colspan="7">No data found!</td>
                    </tr>
                `);
          return;
        }
        let html = "";
        datas.map((data) => {
          html += `
                <tr class="text-center">
                    <td style="color: #e74c3c;font-weight: 600;min-width: 210px">${data.transaction_id}</td>
                    <td><b style="color: #3498db">${data.money}</b></td>
                    <td style="min-width: 210px;"><b>${data.type == "bank" ? "BANK" : "MOMO"}</b></td>
                    <td class="project-state"><span class="badge badge-${data.status == "1" ? "success" : "warning"}">${data.status == "1" ? "success" : "closed"}</span></td>
                    <td style="min-width: 210px;"><b>${data.today}</b></td>
                </tr>
                `;
        });
        $("#list-recharge").html(html);
      };

      var pageno1 = 0;
      var limit1 = 15;
      var page1 = 1;
      $.ajax({
        type: "POST",
        url: "/admin/member/listRecharge/<%=phone%>",
        data: {
          typeid: "1",
          pageno: pageno1,
          limit: limit1,
          language: "vi",
        },
        dataType: "json",
        success: function (response) {
          $("#text-recharge").text(page1 + " / " + response.page_total);
          if (response.status === true) return RenderRecharge(response.datas);
        },
      });

      $("#nextRecharge").click(function (e) {
        pageno1 += limit1;
        e.preventDefault();
        $.ajax({
          type: "POST",
          url: "/admin/member/listRecharge/<%=phone%>",
          data: {
            typeid: "1",
            pageno: pageno1,
            limit: limit1,
            language: "vi",
          },
          dataType: "json",
          success: function (response) {
            if (response.datas.length == 0) {
              $("#nextRecharge").addClass("block-click");
              return (pageno1 -= limit1);
            }
            $("#text-recharge").text(++page1 + " / " + response.page_total);
            if (response.status === true) return RenderRecharge(response.datas);
          },
        });
      });

      $("#previousRecharge").click(function (e) {
        e.preventDefault();
        $("#nextRecharge").removeClass("block-click");
        pageno1 -= limit1;
        if (pageno1 < 0) return (pageno1 = 0);
        $.ajax({
          type: "POST",
          url: "/admin/member/listRecharge/<%=phone%>",
          data: {
            typeid: "1",
            pageno: pageno1,
            limit: limit1,
            language: "vi",
          },
          dataType: "json",
          success: function (response) {
            $("#text-recharge").text(--page1 + " / " + response.page_total);
            if (response.status === true) return RenderRecharge(response.datas);
          },
        });
      });
    </script>
    <!-- Recharge -->

    <!-- Red Envelope -->
    <script>
      const RenderRedenvelopes = (datas) => {
        if (datas.length == 0) {
          $("#list-redenvelope").html(`
                    <tr class="text-center">
                    <td colspan="7">No data found!</td>
                    </tr>
                `);
          return;
        }
        let html = "";
        datas.map((data) => {
          html += ` 
                <tr class="text-center">
                    <td style="color: #e74c3c;font-weight: 600;min-width: 210px">${data.phone}</td>
                    <td><b style="color: #3498db">${data.money}</b></td>
                    <td style="min-width: 210px;"><b>${data.id_redenvelops}</b></td>
                    <td class="project-state"><span class="badge badge-success">success</span></td>
                    <td style="min-width: 210px;"><b>${data.time}</b></td>
                </tr>
                `;
        });
        $("#list-redenvelope").html(html);
      };

      var pageno2 = 0;
      var limit2 = 15;
      var page2 = 1;
      $.ajax({
        type: "POST",
        url: "/admin/member/redenvelope/<%=phone%>",
        data: {
          typeid: "1",
          pageno: pageno2,
          limit: limit2,
          language: "vi",
        },
        dataType: "json",
        success: function (response) {
          $("#text-redenvelope").text(page2 + " / " + response.page_total);
          let total = 0;
          let amount = 0;
          for (let i = 0; i < response.datas.length; i++) {
            total += response.datas[i].money;
            amount += 1;
          }
          $("#totlaide").text(total + " Ä‘ " + " / " + amount + " Lixi");
          if (response.status === true) return RenderRedenvelopes(response.datas);
        },
      });

      $("#nextRedenvelope").click(function (e) {
        pageno2 += limit2;
        e.preventDefault();
        $.ajax({
          type: "POST",
          url: "/admin/member/redenvelope/<%=phone%>",
          data: {
            typeid: "1",
            pageno: pageno2,
            limit: limit2,
            language: "vi",
          },
          dataType: "json",
          success: function (response) {
            if (response.datas.length == 0) {
              $("#nextRedenvelope").addClass("block-click");
              return (pageno2 -= limit2);
            }
            $("#text-redenvelope").text(++page2 + " / " + response.page_total);
            if (response.status === true) return RenderRedenvelopes(response.datas);
          },
        });
      });

      $("#previousRedenvelope").click(function (e) {
        e.preventDefault();
        $("#nextRedenvelope").removeClass("block-click");
        pageno2 -= limit2;
        if (pageno2 < 0) return (pageno2 = 0);
        $.ajax({
          type: "POST",
          url: "/admin/member/redenvelope/<%=phone%>",
          data: {
            typeid: "1",
            pageno: pageno2,
            limit: limit2,
            language: "vi",
          },
          dataType: "json",
          success: function (response) {
            $("#text-redenvelope").text(--page2 + " / " + response.page_total);
            if (response.status === true) return RenderRedenvelopes(response.datas);
          },
        });
      });
    </script>
    <!-- Red Envelope -->

    <!-- BET -->
    <script>
      const RenderBet = (datas) => {
        if (datas.length == 0) {
          $("#list-bet").html(`
                    <tr class="text-center">
                    <td colspan="7">No data found!</td>
                    </tr>
                `);
          return;
        }
        let html = "";
        datas.map((data) => {
          html += `
                <tr class="text-center">
                    <td style="color: #e74c3c;font-weight: 600;min-width: 210px">${data.stage}</td>
                    <td><b style="color: #3498db">${data.status == 1 ? "+" : "-"} ${data.money}</b></td>
                    <td style="min-width: 210px;"><b>${data.game.toUpperCase()} - ${data.source.toUpperCase()}</b></td>
                    <td class="project-state"><span class="badge badge-${data.status == "1" ? "success" : "danger"}">${data.status == "1" ? "win" : "loss"}</span></td>
                    <td style="min-width: 210px;"><b>${data.date}</b></td>
                </tr>
                `;
        });
        $("#list-bet").html(html);
      };

      var pageno3 = 1;
      var limit3 = 30;
      var page3 = 1;
      $.ajax({
        type: "POST",
        url: "/admin/member/bet/<%=phone%>",
        data: {
          typeid: "1",
          pageno: pageno3,
          limit: limit3,
          language: "vi",
        },
        dataType: "json",
        success: function (response) {
          $("#text-bet").text(page3 + " / " + response.page_total);
          if (response.status === true) return RenderBet(response.datas);
        },
      });

      $("#nextBet").click(function (e) {
        pageno3 += limit3;
        e.preventDefault();
        $.ajax({
          type: "POST",
          url: "/admin/member/bet/<%=phone%>",
          data: {
            typeid: "1",
            pageno: pageno3,
            limit: limit3+pageno3,
            language: "vi",
          },
          dataType: "json",
          success: function (response) {
            if (response.datas.length == 0) {
              $("#nextBet").addClass("block-click");
              return (pageno3 -= limit3);
            }
            $("#text-bet").text(++page3 + " / " + response.page_total);
            if (response.status === true) return RenderBet(response.datas);
          },
        });
      });

      $("#previousBet").click(function (e) {
        e.preventDefault();
        $("#nextBet").removeClass("block-click");
        pageno3 -= limit3;
        if (pageno3 < 0) return (pageno3 = 0);
        $.ajax({
          type: "POST",
          url: "/admin/member/bet/<%=phone%>",
          data: {
            typeid: "1",
            pageno: pageno3,
            limit: limit3,
            language: "vi",
          },
          dataType: "json",
          success: function (response) {
            $("#text-bet").text(--page3 + " / " + response.page_total);
            if (response.status === true) return RenderBet(response.datas);
          },
        });
      });
    </script>
    <!-- BET -->
</body>
</html>